(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4715:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var n=r(5322),o=r(1682),l=r(4733),i=r(9303),c=r(7221),a=r(6481);let s=()=>{let[e,t]=(0,o.useState)(null),[r,s]=(0,o.useState)(null),[d,u]=(0,o.useState)(0),[p,h]=(0,o.useState)(null),[g,f]=(0,o.useState)(!1),y=(0,l.gH)();(0,o.useEffect)(()=>{y?(console.log("✅ FHEVM SDK 已初始化:",y),console.dir(y),console.log("\uD83D\uDD11 可用的键:",Object.keys(y)),f(!0)):console.warn("⚠️ FHEVM SDK 尚未初始化")},[y]);let v=async()=>{if(void 0===window.ethereum){alert("请先安装 MetaMask 或其他以太坊钱包扩展！");return}try{let e=new i.k(window.ethereum);await e.send("eth_requestAccounts",[]);let r=await e.getSigner(),n=await r.getAddress();s(e),t(n),console.log("\uD83E\uDD8A 钱包已连接:",n)}catch(e){console.error("❌ 钱包连接失败:",e)}},x=async()=>{if(!r||!e)return alert("请先连接钱包！");if(!g||!p)return alert("SDK 未准备好或未加密数据！");try{let e=await r.getSigner(),t=c.YW(p.encryptedValue),n=c.YW(p.proof),o=new a.NZ("0x964656ad7aE6D2b502F4467B358aC8C070dBc5Bd",["function storeEncryptedValue(bytes encryptedValue, bytes proof) public"],e);console.log("\uD83D\uDCE1 正在发送交易...");let l=await o.storeEncryptedValue(t,n);await l.wait(),console.log("✅ 交易完成:",l.hash),alert("✅ 已将加密数据发送到合约！\nTx: ".concat(l.hash))}catch(e){console.error("❌ 发送失败:",e),alert("❌ 与合约交互失败，请检查控制台日志。")}};return(0,n.jsxs)("div",{style:{padding:"2rem",fontFamily:"sans-serif"},children:[(0,n.jsx)("h1",{children:"\uD83D\uDD10 FHEVM Private Transfer Demo"}),(0,n.jsxs)("p",{children:["SDK 状态:"," ",(0,n.jsx)("strong",{style:{color:g?"green":"red"},children:g?"已初始化 ✅":"未就绪 ❌"})]}),e?(0,n.jsxs)("p",{children:["已连接钱包：",(0,n.jsx)("code",{children:e})]}):(0,n.jsx)("button",{onClick:v,style:{padding:"0.5rem 1rem",background:"#f6851b",border:"none",color:"white",borderRadius:"8px",cursor:"pointer"},children:"\uD83E\uDD8A 连接钱包"}),(0,n.jsx)("hr",{style:{margin:"20px 0"}}),(0,n.jsx)("input",{type:"number",value:d,onChange:e=>u(Number(e.target.value)),placeholder:"输入要加密的金额",style:{padding:"0.5rem",marginRight:"1rem",width:"180px"}}),(0,n.jsx)("button",{onClick:()=>{if(!g)return alert("FHEVM SDK 尚未准备好，请稍等！");if(!d||d<=0)return alert("请输入一个有效的数字");try{var e,t,r;let n=(null==y?void 0:null===(e=y.fhevm)||void 0===e?void 0:e.encryptUint32)||(null==y?void 0:null===(r=y.fhevm)||void 0===r?void 0:null===(t=r.encryptor)||void 0===t?void 0:t.encryptUint32)||(null==y?void 0:y.encryptUint32);if(!n){console.error("❌ 未找到 encryptUint32 方法，fhevm 结构如下:",y),alert("SDK 中未找到 encryptUint32 方法，请查看控制台日志！");return}let{encryptedValue:o,proof:l}=n(d);console.log("\uD83D\uDD10 加密结果:",o),console.log("\uD83E\uDDFE 加密证明:",l),h({encryptedValue:o,proof:l}),alert("✅ 加密成功！")}catch(e){console.error("加密失败:",e),alert("❌ 加密失败，请检查控制台日志。")}},children:"加密"}),(0,n.jsx)("button",{onClick:()=>{if(!g)return alert("FHEVM SDK 尚未准备好！");if(!p)return alert("请先执行加密操作！");try{var e,t,r;let n=(null==y?void 0:null===(e=y.fhevm)||void 0===e?void 0:e.decryptUint32)||(null==y?void 0:null===(r=y.fhevm)||void 0===r?void 0:null===(t=r.decryptor)||void 0===t?void 0:t.decryptUint32)||(null==y?void 0:y.decryptUint32);if(!n){console.error("❌ 未找到 decryptUint32 方法，fhevm 结构如下:",y),alert("SDK 中未找到 decryptUint32 方法，请查看控制台日志！");return}let o=n(p.encryptedValue,p.proof);console.log("\uD83D\uDD13 解密结果:",o),alert("解密结果: ".concat(o))}catch(e){console.error("解密失败:",e),alert("❌ 解密失败，请检查日志。")}},style:{marginLeft:"10px"},children:"解密"}),(0,n.jsx)("hr",{style:{margin:"20px 0"}}),(0,n.jsx)("button",{onClick:x,style:{padding:"0.5rem 1rem",background:"#0070f3",color:"white",border:"none",borderRadius:"8px",cursor:"pointer"},children:"\uD83D\uDE80 将加密数据发送到合约"}),p&&(0,n.jsxs)("div",{style:{marginTop:"20px",background:"#f0f0f0",padding:"1rem",borderRadius:"8px"},children:[(0,n.jsx)("h3",{children:"\uD83D\uDCE6 加密结果"}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Encrypted:"})," ",p.encryptedValue]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Proof:"})," ",p.proof]})]})]})};function d(){return console.log("\uD83D\uDCC4 Page mounted (client)"),(0,n.jsx)(s,{})}},4733:(e,t,r)=>{"use strict";r.d(t,{gO:()=>s,gH:()=>d});var n=r(5322),o=r(1682);async function l(e){return console.log("\uD83E\uDDE0 Initializing FHEVM SDK with config:",e),await new Promise(e=>setTimeout(e,500)),console.log("✅ FHEVM SDK initialized"),{encryptUint32:e=>({encryptedValue:"enc_".concat(e,"_").concat(Math.random().toString(36).substring(2,8)),proof:"proof_".concat(Date.now())}),decryptUint32(e,t){console.log("\uD83D\uDD13 decrypt called:",e,t);try{let t=e.split("_");return Number(t[1])||0}catch(e){return console.error("解密失败:",e),0}}}}var i=r(6326),c=r.n(i);let a=(0,o.createContext)(null);function s(e){let{children:t}=e,[r,i]=(0,o.useState)(null),[s,d]=(0,o.useState)(""),[u,p]=(0,o.useState)(0xaa36a7);return(0,o.useEffect)(()=>{(async function(){try{console.log("\uD83D\uDD0D 检查钱包中...");let e=await c()();if(!e){alert("❌ 未检测到钱包插件，请安装 MetaMask！");return}console.log("\uD83D\uDD17 正在请求连接钱包...");let t=await e.request({method:"eth_requestAccounts"}),r=await e.request({method:"eth_chainId"}),n=parseInt(r,16);console.log("✅ 钱包已连接:",t[0]),console.log("\uD83C\uDF10 当前网络:",n),d(t[0]),p(n),console.log("\uD83D\uDE80 初始化 FHEVM SDK...");let o=await l({chainId:n,rpcUrl:"https://rpc.sepolia.org",contractAddress:"0x9F8069282814a1177C1f6b8D7d8f7cC11A663554"});console.log("✅ FHEVM SDK 初始化成功"),i(o)}catch(e){console.error("❌ FHEVMProvider 初始化失败:",e)}})()},[]),(0,n.jsx)(a.Provider,{value:{fhevm:r,account:s,chainId:u},children:t})}function d(){let e=(0,o.useContext)(a);if(!e)throw Error("useFHEVM must be used within a FHEVMProvider");return e}},6867:(e,t,r)=>{Promise.resolve().then(r.bind(r,4715))}},e=>{var t=t=>e(e.s=t);e.O(0,[666,237,597,358],()=>t(6867)),_N_E=e.O()}]);